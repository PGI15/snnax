<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-layers/predefined" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Predefined Layers | SNNAX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pgi15.github.io/snnax/layers/predefined"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Predefined Layers | SNNAX"><meta data-rh="true" name="description" content="The snnax.snn.layers module provides a range of predefined layers that simplify the construction of spiking neural networks (SNNs). These layers offer common functionalities and neuron models, allowing for easier and more efficient network design."><meta data-rh="true" property="og:description" content="The snnax.snn.layers module provides a range of predefined layers that simplify the construction of spiking neural networks (SNNs). These layers offer common functionalities and neuron models, allowing for easier and more efficient network design."><link data-rh="true" rel="icon" href="/snnax/img/snnax.ico"><link data-rh="true" rel="canonical" href="https://pgi15.github.io/snnax/layers/predefined"><link data-rh="true" rel="alternate" href="https://pgi15.github.io/snnax/layers/predefined" hreflang="en"><link data-rh="true" rel="alternate" href="https://pgi15.github.io/snnax/layers/predefined" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/snnax/assets/css/styles.3e792b5f.css">
<script src="/snnax/assets/js/runtime~main.c27d72b8.js" defer="defer"></script>
<script src="/snnax/assets/js/main.9dfc1c68.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/snnax/"><div class="navbar__logo"><img src="/snnax/img/snnax.svg" alt="SNNAX Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/snnax/img/snnax.svg" alt="SNNAX Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/snnax/">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/PGI15/snnax" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/snnax/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/snnax/gettingStarted/installation">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/snnax/architecture/intro">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/snnax/layers/intro">Layers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/snnax/layers/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/snnax/layers/predefined">Predefined Layers</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/snnax/functions">Functions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/snnax/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Layers</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Predefined Layers</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Predefined Layers</h1>
<p>The <code>snnax.snn.layers</code> module provides a range of predefined layers that simplify the construction of spiking neural networks (SNNs). These layers offer common functionalities and neuron models, allowing for easier and more efficient network design.
Each of these predefined layers can be combined to build complex and tailored SNN architectures, leveraging the built-in functionalities for efficient and effective network design. Below is an overview of the available predefined layers:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="batchnormlayer">BatchNormLayer<a href="#batchnormlayer" class="hash-link" aria-label="Direct link to BatchNormLayer" title="Direct link to BatchNormLayer">​</a></h2>
<p>The <code>BatchNormLayer</code> subclass of <code>eqx.Module</code>, applies batch normalization to the input, normalizing the features to stabilize learning and enhance convergence. This layer is useful for mitigating internal covariate shift during training.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments">Arguments<a href="#arguments" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>eps (float)</code>: A small value added to the variance to avoid division by zero.</li>
<li><code>forget_weight (float)</code>: The weight of the previous mean and variance in the current batch normalization.</li>
<li><code>gamma (float)</code>: The scaling factor for the normalized input, default is 0.8.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flatten">Flatten<a href="#flatten" class="hash-link" aria-label="Direct link to Flatten" title="Direct link to Flatten">​</a></h2>
<p>The <code>Flatten</code> subclass of <code>eqx.Module</code>, reshapes the input tensor into a 1D tensor. This is particularly useful for transitioning between different types of layers, such as moving from convolutional to fully connected layers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="simpleiaf">SimpleIAF<a href="#simpleiaf" class="hash-link" aria-label="Direct link to SimpleIAF" title="Direct link to SimpleIAF">​</a></h2>
<p>The <code>SimpleIAF</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, implements a basic integrate-and-fire (IAF) neuron model. It integrates raw synaptic input without explicit modeling of synaptic currents and requires one constant to simulate a constant leak in membrane potential.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>−</mo><mtext>leak</mtext><mo stretchy="false">)</mo><mo>+</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;=  (\text{membrane\_potential}(t-1) - \text{reset\_val} \cdot synaptic\_input - \text{leak}) + \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">leak</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-1">Arguments<a href="#arguments-1" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>leak (float)</code>: The leak constant for the membrane potential, default is 0.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>stop_reset_grad (bool)</code>: Whether to stop the gradient during the reset operation, default is True.</li>
<li><code>reset_val (Optional[float])</code>: The reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="iaf">IAF<a href="#iaf" class="hash-link" aria-label="Direct link to IAF" title="Direct link to IAF">​</a></h2>
<p>The <code>IAF</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, models an integrate-and-fire neuron with an optional constant leak. By default, no leak is applied, but it can be configured to include a leak, providing flexibility for different neuron dynamics.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>−</mo><mtext>leak</mtext><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>β</mi><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;= \alpha \cdot (\text{membrane\_potential}(t-1)  - \text{reset\_val} \cdot synaptic\_input - \text{leak}) + (1 - \alpha) \cdot \text{synaptic\_current}(t-1) \\
\text{synaptic\_current}(t) &amp;= \beta \cdot \text{synaptic\_current}(t-1) + (1 - \beta) \cdot \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">leak</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-2">Arguments<a href="#arguments-2" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (Union[Sequence[float], Array])</code>: The decay constants for the membrane potential and synaptic current. Index 0 describes the decay constant of the membrane potential <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>, Index 1 describes the decay constant of the synaptic current <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span>.</li>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>leak (float)</code>: The leak constant for the membrane potential, default is 0.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>stop_reset_grad (bool)</code>: Whether to stop the gradient during the reset operation, default is True.</li>
<li><code>reset_val (Optional[float])</code>: The reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="li">LI<a href="#li" class="hash-link" aria-label="Direct link to LI" title="Direct link to LI">​</a></h2>
<p>The <code>LI</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, represents a Leaky Integrator (LI) neuron, integrating over synaptic inputs with a leaky mechanism. This layer is suitable for tasks requiring leaky integration without complex dynamics.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;= \alpha \cdot \text{membrane\_potential}(t-1) + (1 - \alpha) \cdot \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{membrane\_potential}(t)
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-3">Arguments<a href="#arguments-3" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (float)</code>: The decay constant for the membrane potential <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="simplelif">SimpleLIF<a href="#simplelif" class="hash-link" aria-label="Direct link to SimpleLIF" title="Direct link to SimpleLIF">​</a></h2>
<p>The <code>SimpleLIF</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, a straightforward implementation of a leaky integrate-and-fire (LIF) neuron that does not explicitly model synaptic currents. It requires a decay constant to simulate membrane potential leak.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;= \alpha \cdot (\text{membrane\_potential}(t-1)  - \text{reset\_val} \cdot synaptic\_input) + (1 - \alpha) \cdot \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-4">Arguments<a href="#arguments-4" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (float)</code>: Initial value of the trainable decay constant for the membrane potential <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>.</li>
<li><code>spike_fn (SpikeFn)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>stop_reset_grad (bool)</code>: Whether to stop the gradient during the reset operation, default is True.</li>
<li><code>reset_val (Optional[float])</code>: The reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
<li><code>shape (Optional[StateShape])</code>: If given, the parameters will be expanded into vectors and initialized accordingly.</li>
<li><code>key (Optional[PRNGKey])</code>: Used to initialize the parameters.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lif">LIF<a href="#lif" class="hash-link" aria-label="Direct link to LIF" title="Direct link to LIF">​</a></h2>
<p>The <code>LIF</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, models a leaky integrate-and-fire neuron with synaptic currents. It uses two decay constants: one for the membrane potential and another for the synaptic current, providing a detailed representation of neuron dynamics.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo stretchy="false">)</mo><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>β</mi><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;= \alpha \cdot (\text{membrane\_potential}(t-1)  - (\text{membrane\_potential}(t-1) - \text{reset\_val}) \cdot synaptic\_input) + (1 - \alpha) \cdot \text{synaptic\_current}(t-1) \\
\text{synaptic\_current}(t) &amp;= \beta \cdot \text{synaptic\_current}(t-1) + (1 - \beta) \cdot \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-5">Arguments<a href="#arguments-5" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (Union[Sequence[float], Array])</code>: Initial value of the trainable decay constants for the membrane potential and synaptic current. Index 0 describes the decay constant of the membrane potential <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>, Index 1 describes the decay constant of the synaptic current <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span>.</li>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>stop_reset_grad (bool)</code>: Whether to stop the gradient during the reset operation, default is True.</li>
<li><code>reset_val (Optional[float])</code>: The reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
<li><code>shape (Optional[StateShape])</code>: If given, the parameters will be expanded into vectors and initialized accordingly.</li>
<li><code>key (Optional[PRNGKey])</code>: Used to initialize the parameters.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lifsoftreset">LIFSoftReset<a href="#lifsoftreset" class="hash-link" aria-label="Direct link to LIFSoftReset" title="Direct link to LIFSoftReset">​</a></h2>
<p>The <code>LIFSoftReset</code> subclass of <code>snn.LIF</code> similar to the <code>LIF</code> layer but applies an additive (relative) reset when a neuron spikes. Instead of setting the membrane potential to a fixed reset value, it adds a reset value to the current membrane potential.
it has the same arguments as <code>LIF</code> layer.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>β</mi><mo>⋅</mo><mtext>synaptic_current</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>⋅</mo><mtext>synaptic_input</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{membrane\_potential}(t) &amp;= \alpha \cdot (\text{membrane\_potential}(t-1)  - \text{reset\_val} \cdot synaptic\_input) + (1 - \alpha) \cdot \text{synaptic\_current}(t-1) \\
\text{synaptic\_current}(t) &amp;= \beta \cdot \text{synaptic\_current}(t-1) + (1 - \beta) \cdot \text{synaptic\_input} \\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_current</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">synaptic_input</span></span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adaptivelif">AdaptiveLIF<a href="#adaptivelif" class="hash-link" aria-label="Direct link to AdaptiveLIF" title="Direct link to AdaptiveLIF">​</a></h2>
<p>The <code>AdaptiveLIF</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, implements an adaptive exponential leaky integrate-and-fire neuron.</p>
<p>State update function is given by the following equation:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>adaptive_state</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>β</mi><mo>⋅</mo><mtext>adaptive_state</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>a</mi><mo>⋅</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mtext>reset_val</mtext><mo>⋅</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>s</mi><mi>y</mi><mi>n</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>−</mo><mtext>adaptive_state</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>spike_output</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>spike_fn</mtext><mo stretchy="false">(</mo><mtext>membrane_potential</mtext><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>threshold</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{adaptive\_state}(t) &amp;=  \beta \cdot \text{adaptive\_state}(t-1) + (1 - \beta) \cdot a \cdot \text{membrane\_potential}(t-1) - b \cdot synaptic\_input\\
\text{membrane\_potential}(t) &amp;= \alpha \cdot (\text{membrane\_potential}(t-1)  - \text{reset\_val} \cdot synaptic\_input) + (1 - \alpha) \cdot (synaptic\_input - \text{adaptive\_state}(t))\\
\text{spike\_output} &amp;= \text{spike\_fn}(\text{membrane\_potential}(t) - \text{threshold})
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">adaptive_state</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">spike_output</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">adaptive_state</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">reset_val</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">sy</span><span class="mord mathnormal">na</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">adaptive_state</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">spike_fn</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">membrane_potential</span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">threshold</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-6">Arguments<a href="#arguments-6" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (float)</code>: Initial value of the trainable decay constant for the membrane potential <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span>.</li>
<li><code>ada_decay_constant (float)</code>: Initial value of the trainable decay constant for the adaptive threshold <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span>, default is 0.8.</li>
<li><code>ada_step_val (float)</code>: Initial value of the trainable step value for the adaptive threshold <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span>, default is 1.0.</li>
<li><code>ada_coupling_var (float)</code>: Initial value of the trainable coupling variable for the adaptive threshold <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span>, default is 0.5.</li>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>stop_reset_grad (bool)</code>: Whether to stop the gradient during the reset operation, default is True.</li>
<li><code>reset_val (Optional[float])</code>: The reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
<li><code>shape (Optional[StateShape])</code>: If given, the parameters will be expanded into vectors and initialized accordingly.</li>
<li><code>key (Optional[PRNGKey])</code>: Used to initialize the parameters.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="maxpool1d">MaxPool1d<a href="#maxpool1d" class="hash-link" aria-label="Direct link to MaxPool1d" title="Direct link to MaxPool1d">​</a></h2>
<p>The <code>MaxPool1d</code> subclass of <code>eqx.nn.MaxPool1d</code> and <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, performs 1D max pooling on the input tensor and applies a spike operation to the output.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-7">Arguments<a href="#arguments-7" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<p>it has default arguments similar to <a href="https://docs.kidger.site/equinox/api/nn/pool/#equinox.nn.MaxPool1d" target="_blank" rel="noopener noreferrer"><code>eqx.nn.MaxPool1d</code></a> layer, in addition to the following arguments:</p>
<ul>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="maxpool2d">MaxPool2d<a href="#maxpool2d" class="hash-link" aria-label="Direct link to MaxPool2d" title="Direct link to MaxPool2d">​</a></h2>
<p>The <code>MaxPool2d</code> subclass of <code>eqx.nn.MaxPool2d</code>,<a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, performs 2D max pooling on the input tensor and applies a spike operation to the output.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-8">Arguments<a href="#arguments-8" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<p>it has default arguments similar to <a href="https://docs.kidger.site/equinox/api/nn/pool/#equinox.nn.MaxPool2d" target="_blank" rel="noopener noreferrer"><code>eqx.nn.MaxPool2d</code></a> layer, in addition to the following arguments:</p>
<ul>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resnetblock">ResNetBlock<a href="#resnetblock" class="hash-link" aria-label="Direct link to ResNetBlock" title="Direct link to ResNetBlock">​</a></h2>
<p>The <code>ResNetBlock</code> subclass of <code>eqx.Module</code>, implements a residual block used in ResNet architectures. It includes two convolutional layers with a skip connection that bypasses the second convolutional layer, allowing for deeper networks with improved training dynamics.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-9">Arguments<a href="#arguments-9" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>layer_order (Sequence)</code>: Represents the order of layers in the block, which can be &#x27;c&#x27; for convolutional layers or &#x27;l&#x27; for linear layers.</li>
<li><code>layer_params (Sequence)</code>: The parameters for each layer in the block. which represents [in_channels, out_channels, kernel_size, stride, padding] for convolutional layers and [in_features, out_features] for linear layers.</li>
<li><code>stateful_layer_type (str)</code>: The type of stateful layer to use in the block, which can be &#x27;LIF&#x27; or &#x27;SigmaDelta&#x27;, default is &#x27;LIF&#x27;.</li>
<li><code>key (Optional[PRNGKey])</code>: The random key for initialization, default is None.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sigmadelta">SigmaDelta<a href="#sigmadelta" class="hash-link" aria-label="Direct link to SigmaDelta" title="Direct link to SigmaDelta">​</a></h2>
<p>The <code>SigmaDelta</code> subclass of <a href="/snnax/layers/intro#statefullayer"><code>snn.StatefulLayer</code></a>, models a Sigma-Delta neuron, providing another variant of spiking neuron models with specific integration and firing properties.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-10">Arguments<a href="#arguments-10" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>threshold (float)</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for the layer, default is None. If None, the layer is initialized with zeros.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="srm">SRM<a href="#srm" class="hash-link" aria-label="Direct link to SRM" title="Direct link to SRM">​</a></h2>
<p>The <code>SRM</code> (Spike Response Model) layer simulates the postsynaptic response to spike input. It models the synaptic response of a neuron to incoming spikes, useful for studying spike-timing dependent plasticity and other synaptic effects.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-11">Arguments<a href="#arguments-11" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h4>
<ul>
<li><code>decay_constants (Union[Sequence[float], jnp.ndarray, TrainableArray])</code>: Initial value of the trainable decay constants for the membrane potential and synaptic current. Index 0 describes the decay constant of the membrane potential, Index 1 describes the decay constant of the synaptic current.</li>
<li><code>r_decay_constants (Union[Sequence[float], jnp.ndarray, TrainableArray])</code>: Initial value of the trainable decay constants for the refractory period, default is 0.9.</li>
<li><code>spike_fn (Callable)</code>: The surrogate function for the spike operation, default is <a href="/snnax/functions#superspike_surrogate"><code>superspike_surrogate(10.)</code></a>.</li>
<li><code>threshold (Union[float, jnp.ndarray])</code>: The threshold for the membrane potential to spike, default is 1.</li>
<li><code>reset_val (Optional[Union[float, jnp.ndarray, TrainableArray])</code>: Initial value of the trainable reset value for the membrane potential, default is None. If None, the reset value is set to 0.</li>
<li><code>stop_reset_grad (Optional[bool])</code>: Whether to stop the gradient from propagating through the refectory potential, default is True.</li>
<li><code>init_fn (Optional[Callable])</code>: The initialization function for layer states, default is None. If None, the layer is initialized with zeros.</li>
<li><code>input_shape (Union[Sequence[int],int,None])</code>: The shape of the neuron layer.</li>
<li><code>shape (Union[Sequence[int],int,None])</code>: The shape of the layer.</li>
<li><code>key (jrand.PRNGKey)</code>: Random key for initialization.<!-- -->
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span></span>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/snnax/layers/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/snnax/functions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Functions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#batchnormlayer" class="table-of-contents__link toc-highlight">BatchNormLayer</a></li><li><a href="#flatten" class="table-of-contents__link toc-highlight">Flatten</a></li><li><a href="#simpleiaf" class="table-of-contents__link toc-highlight">SimpleIAF</a></li><li><a href="#iaf" class="table-of-contents__link toc-highlight">IAF</a></li><li><a href="#li" class="table-of-contents__link toc-highlight">LI</a></li><li><a href="#simplelif" class="table-of-contents__link toc-highlight">SimpleLIF</a></li><li><a href="#lif" class="table-of-contents__link toc-highlight">LIF</a></li><li><a href="#lifsoftreset" class="table-of-contents__link toc-highlight">LIFSoftReset</a></li><li><a href="#adaptivelif" class="table-of-contents__link toc-highlight">AdaptiveLIF</a></li><li><a href="#maxpool1d" class="table-of-contents__link toc-highlight">MaxPool1d</a></li><li><a href="#maxpool2d" class="table-of-contents__link toc-highlight">MaxPool2d</a></li><li><a href="#resnetblock" class="table-of-contents__link toc-highlight">ResNetBlock</a></li><li><a href="#sigmadelta" class="table-of-contents__link toc-highlight">SigmaDelta</a></li><li><a href="#srm" class="table-of-contents__link toc-highlight">SRM</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/snnax/">Tutorial</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>